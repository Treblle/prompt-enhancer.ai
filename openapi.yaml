openapi: 3.0.3
info:
  title: AI Prompt Enhancer API
  description: |
    An API that transforms basic prompts into optimized, context-rich instructions for AI language models.
    Works with both Mistral and OpenAI to enhance prompts and generate better AI responses.
  version: 1.0.0
  contact:
    name: Prompt Enhancer Team
    email: rahul@treblle.com
    url: https://prompt-enhancer.ai
  license:
    name: MIT License
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://prompt-enhancer.ai/v1
    description: Production server
  - url: https://api.prompt-enhancer.cloudflare.dev/v1
    description: Cloudflare CDN
  - url: https://cdn.prompt-enhancer.ai/v1
    description: CDN-backed production server
  - url: http://localhost:5000/v1
    description: Local development server

tags:
  - name: Authentication
    description: Authentication endpoints for token management
  - name: Prompts
    description: Prompt enhancement and management operations

security:
  - BearerAuth: []

paths:
  /auth/tokens:
    post:
      summary: Generate authentication token
      description: Generates a JWT token for API authentication
      operationId: generateToken
      tags:
        - Authentication
      security: [] # No auth required for token generation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TokenRequest"
            examples:
              basicAuth:
                value:
                  clientId: "frontend-client"
                  clientSecret: "your-api-key-here"
      responses:
        "200":
          description: Successfully generated token
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            Content-Encoding:
              schema:
                type: string
              description: Compression method used for the response
              example: "gzip"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"
        "400":
          description: Bad request - Invalid input
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid credentials
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - Rate limit exceeded
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/validations:
    post:
      summary: Validate authentication token
      description: Validates a JWT token and returns its information
      operationId: validateToken
      tags:
        - Authentication
      security: [] # No auth required for token validation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
              properties:
                token:
                  type: string
                  description: JWT token to validate
            examples:
              tokenValidation:
                value:
                  token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        "200":
          description: Token validation successful
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            Content-Encoding:
              schema:
                type: string
              description: Compression method used for the response
              example: "gzip"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                    description: Whether the token is valid
                  clientId:
                    type: string
                    description: Client ID from the token
                  scope:
                    type: string
                    description: Token scope
                  expires:
                    type: string
                    format: date-time
                    description: Token expiration time
              examples:
                validToken:
                  value:
                    valid: true
                    clientId: "frontend-client"
                    scope: "api:access"
                    expires: "2023-07-16T14:30:00Z"
        "400":
          description: Bad request - Invalid input
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid token
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /prompts:
    post:
      summary: Create an enhanced prompt
      description: Takes a basic prompt and returns an optimized, context-rich version
      operationId: createEnhancedPrompt
      tags:
        - Prompts
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PromptRequest"
            examples:
              basicPrompt:
                value:
                  text: "Write about quantum computing"
                  format: "structured"
      responses:
        "200":
          description: Successfully enhanced prompt
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            Content-Encoding:
              schema:
                type: string
              description: Compression method used for the response
              example: "gzip"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PromptResponse"
              examples:
                successResponse:
                  value:
                    id: "prompt_abc123"
                    originalText: "Write about quantum computing"
                    enhancedText: "You are an expert physicist with deep knowledge in quantum mechanics and quantum computing. Provide a comprehensive explanation of quantum computing covering: the fundamental principles (superposition, entanglement, quantum bits or qubits), how quantum computing differs from classical computing, current developments in the field, major challenges (decoherence, error correction), potential applications (cryptography, optimization problems, simulation of quantum systems), and the future outlook. Include specific examples and analogies to help understand complex concepts. Structure your response with clear sections and use technical terminology while making the content accessible to someone with a basic understanding of physics and computing."
                    format: "structured"
                    createdAt: "2023-07-15T14:30:00Z"
        "400":
          description: Bad request - Invalid input
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Authentication failed
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests - Rate limit exceeded
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "413":
          description: Payload Too Large - Input text exceeds maximum allowed size
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    get:
      summary: List enhanced prompts
      description: Returns a paginated list of previously enhanced prompts
      operationId: listPrompts
      tags:
        - Prompts
      security:
        - BearerAuth: []
      parameters:
        - name: limit
          in: query
          description: Maximum number of prompts to return per page
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: offset
          in: query
          description: Number of prompts to skip for pagination
          schema:
            type: integer
            default: 0
            minimum: 0
      responses:
        "200":
          description: List of prompts
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            Content-Encoding:
              schema:
                type: string
              description: Compression method used for the response
              example: "gzip"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                type: object
                properties:
                  prompts:
                    type: array
                    description: Array of enhanced prompts
                    items:
                      $ref: "#/components/schemas/PromptResponse"
                  total:
                    type: integer
                    description: Total number of prompts available
              examples:
                successResponse:
                  value:
                    prompts:
                      - id: "prompt_abc123"
                        originalText: "Write about quantum computing"
                        enhancedText: "You are an expert physicist with deep knowledge in quantum mechanics..."
                        format: "structured"
                        createdAt: "2023-07-15T14:30:00Z"
                      - id: "prompt_def456"
                        originalText: "Explain machine learning"
                        enhancedText: "As an AI researcher and data scientist with expertise in machine learning..."
                        format: "structured"
                        createdAt: "2023-07-15T15:30:00Z"
                    total: 2
        "401":
          description: Unauthorized - Authentication failed
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /prompts/{promptId}:
    get:
      summary: Get specific prompt
      description: Retrieves details of a single enhanced prompt
      operationId: getPrompt
      tags:
        - Prompts
      security:
        - BearerAuth: []
      parameters:
        - name: promptId
          in: path
          required: true
          description: Unique identifier of the prompt to retrieve
          schema:
            type: string
            format: string
            example: "prompt_abc123"
            pattern: "^prompt_[a-zA-Z0-9]{6,32}$"
      responses:
        "200":
          description: Prompt details retrieved successfully
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            Content-Encoding:
              schema:
                type: string
              description: Compression method used for the response
              example: "gzip"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PromptResponse"
              examples:
                successResponse:
                  value:
                    id: "prompt_abc123"
                    originalText: "Write about quantum computing"
                    enhancedText: "You are an expert physicist with deep knowledge in quantum mechanics..."
                    format: "structured"
                    createdAt: "2023-07-15T14:30:00Z"
        "401":
          description: Unauthorized - Authentication failed
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Prompt not found
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      summary: Update prompt
      description: Updates and re-enhances a previously created prompt
      operationId: updatePrompt
      tags:
        - Prompts
      security:
        - BearerAuth: []
      parameters:
        - name: promptId
          in: path
          required: true
          description: Unique identifier of the prompt to update
          schema:
            type: string
            format: string
            example: "prompt_abc123"
            pattern: "^prompt_[a-zA-Z0-9]{6,32}$"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PromptRequest"
            examples:
              updatePrompt:
                value:
                  text: "Write about advanced quantum computing"
                  format: "structured"
      responses:
        "200":
          description: Prompt successfully updated
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            Content-Encoding:
              schema:
                type: string
              description: Compression method used for the response
              example: "gzip"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PromptResponse"
              examples:
                successResponse:
                  value:
                    id: "prompt_abc123"
                    originalText: "Write about advanced quantum computing"
                    enhancedText: "You are a leading quantum physicist specializing in quantum computing..."
                    format: "structured"
                    createdAt: "2023-07-15T14:30:00Z"
                    updatedAt: "2023-07-15T16:45:00Z"
        "400":
          description: Bad request - Invalid input
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - Authentication failed
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Prompt not found
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "413":
          description: Payload Too Large - Input text exceeds maximum allowed size
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete prompt
      description: Removes a prompt from history
      operationId: deletePrompt
      tags:
        - Prompts
      security:
        - BearerAuth: []
      parameters:
        - name: promptId
          in: path
          required: true
          description: Unique identifier of the prompt to delete
          schema:
            type: string
            format: string
            example: "prompt_abc123"
            pattern: "^prompt_[a-zA-Z0-9]{6,32}$"
      responses:
        "204":
          description: Prompt successfully deleted
          headers:
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
        "401":
          description: Unauthorized - Authentication failed
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Prompt not found
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /health:
    get:
      summary: Health check endpoint
      description: Simple endpoint to check if the API is running
      operationId: healthCheck
      tags:
        - System
      security: [] # No auth required for health check
      responses:
        "200":
          description: API is healthy
          headers:
            Content-Type:
              schema:
                type: string
              description: Content type of the response
              example: "application/json"
            Content-Encoding:
              schema:
                type: string
              description: Compression method used for the response
              example: "gzip"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"
            X-Frame-Options:
              schema:
                type: string
              description: Prevents clickjacking attacks
              example: "DENY"
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"
                  timestamp:
                    type: string
                    format: date-time
              examples:
                healthResponse:
                  value:
                    status: "ok"
                    timestamp: "2023-07-15T14:30:00Z"
                    version: "1.0.0"
                    environment: "production"

components:
  schemas:
    TokenRequest:
      type: object
      description: Request to generate an authentication token
      required:
        - clientSecret
      properties:
        clientId:
          type: string
          description: Client identifier
          example: "frontend-client"
        clientSecret:
          type: string
          description: Client secret (API key)
          example: "your-api-key-here"

    TokenResponse:
      type: object
      description: Authentication token response
      properties:
        access_token:
          type: string
          description: JWT access token
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        token_type:
          type: string
          description: Token type
          example: "Bearer"
        expires_in:
          type: integer
          description: Token expiration time in seconds
          example: 86400
        scope:
          type: string
          description: Token scope
          example: "api:access"

    PromptRequest:
      type: object
      description: Request body for creating or updating a prompt enhancement
      required:
        - text
      properties:
        text:
          type: string
          description: The original prompt text to be enhanced
          minLength: 1
          maxLength: 8000
          example: "Write about quantum computing"
        format:
          type: string
          description: The desired format for the enhanced prompt
          enum:
            - structured
            - paragraph
            - bullet
            - conversational
          default: structured
          example: "structured"

    PromptResponse:
      type: object
      description: Response containing the enhanced prompt information
      properties:
        id:
          type: string
          description: Unique identifier for the enhanced prompt
          example: "prompt_abc123"
        originalText:
          type: string
          description: The original prompt text provided by the user
          example: "Write about quantum computing"
        enhancedText:
          type: string
          description: The enhanced, more detailed prompt text
          example: "As a professional expert in quantum computing, provide a comprehensive overview..."
        format:
          type: string
          description: The format used for enhancing the prompt
          enum:
            - structured
            - paragraph
            - bullet
            - conversational
          example: "structured"
        createdAt:
          type: string
          format: date-time
          description: Timestamp of prompt creation
          example: "2023-07-15T14:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Timestamp of the last prompt update (if applicable)
          example: "2023-07-15T15:45:00Z"

    Error:
      type: object
      description: Standard error response format
      properties:
        error:
          type: object
          description: Error details
          properties:
            code:
              type: string
              description: Machine-readable error code
              example: "validation_error"
            message:
              type: string
              description: Human-readable error message
              example: "The 'text' field is required"
            details:
              type: object
              description: Additional error details (when available)
              example: { "param": "text", "reason": "missing_required_field" }

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from the /auth/tokens endpoint

  headers:
    X-RateLimit-Limit:
      description: Request limit per minute
      schema:
        type: integer
      example: 100
    X-RateLimit-Remaining:
      description: Remaining requests allowed in the current period
      schema:
        type: integer
      example: 95
    X-RateLimit-Reset:
      description: The time at which the current rate limit window resets (Unix timestamp)
      schema:
        type: integer
      example: 1626369250
